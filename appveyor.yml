# ===============================
# AppVeyor CI 配置 (Classic 格式)
# ===============================
shallow_clone: true

branches:
  only:
    - master
    - appveyor

# 指定构建环境
os:
  # - Visual Studio 2022
  - Ubuntu2204

environment:
  matrix:
    - TOOLSET: vs2022

# ===============================
# 构建步骤
# ===============================
build_script:
  # Windows 构建
  # - cmd: if "%APPVEYOR_BUILD_WORKER_IMAGE%"=="Visual Studio 2022" call install_windows.bat

  # Linux Step 1: 安装依赖
  - sh: if [ "$APPVEYOR_BUILD_WORKER_IMAGE" = "Ubuntu2204" ]; then bash ./CI/install_linux_step1_deps.sh; fi

  # Linux Step 2: vcpkg + CMake configure
  - sh: if [ "$APPVEYOR_BUILD_WORKER_IMAGE" = "Ubuntu2204" ]; then bash ./CI/install_linux_step2_configure.sh Release; fi

  # Linux Step 3: 编译
  - sh: if [ "$APPVEYOR_BUILD_WORKER_IMAGE" = "Ubuntu2204" ]; then bash ./CI/install_linux_step3_build.sh; fi